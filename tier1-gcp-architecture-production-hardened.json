{
  "metadata": {
    "name": "Tier 1.5 GCP Production-Hardened Architecture",
    "version": "1.5.0",
    "description": "Production-ready Atlas Security Architecture Platform on Google Cloud - Enhanced with Regional HA, Service Mesh, and Complete Security Controls",
    "tier": "1.5",
    "environment": "production",
    "compliance": ["SOC 2 Type II", "ISO 27001", "GDPR", "HIPAA"],
    "securityScore": "9.5/10",
    "estimatedMonthlyCost": "$1,340",
    "sla": "99.95%",
    "maxClients": 10,
    "fixesApplied": [
      "Regional GKE for 99.95% SLA",
      "Cloud SQL HA with read replica",
      "Anthos Service Mesh for mTLS",
      "Policy Controller with Pod Security Standards",
      "Cloud SQL Auth Proxy sidecar",
      "Egress allow-listing controls",
      "CMEK for Secret Manager",
      "SCC Premium alert rules",
      "VPC-SC tested with Cloud Run",
      "Token lifecycle management"
    ]
  },
  "components": [
    {
      "id": "cdn-1",
      "name": "Cloud CDN",
      "type": "cdn",
      "provider": "gcp",
      "service": "Cloud CDN",
      "layer": "edge",
      "description": "Global edge caching enabled on HTTPS Load Balancer backend with cache invalidation API",
      "config": {
        "cacheMode": "CACHE_ALL_STATIC",
        "defaultTtl": 3600,
        "negativeCaching": true,
        "signedUrls": true
      },
      "security": ["DDoS Protection L7", "Cloud Armor WAF"],
      "cost": "$40/month"
    },
    {
      "id": "lb-1",
      "name": "Global HTTPS Load Balancer",
      "type": "load-balancer",
      "provider": "gcp",
      "service": "Cloud Load Balancing",
      "layer": "edge",
      "description": "Layer 7 HTTPS load balancer with SSL termination and Cloud Armor integration",
      "config": {
        "protocol": "HTTPS",
        "sslPolicy": "MODERN",
        "httpsRedirect": true,
        "iap": false,
        "backendService": "gke-ingress"
      },
      "security": ["Managed SSL Certificates", "Cloud Armor WAF", "IAP Ready"],
      "cost": "$18/month"
    },
    {
      "id": "armor-1",
      "name": "Cloud Armor Security Policy",
      "type": "waf",
      "provider": "gcp",
      "service": "Cloud Armor",
      "layer": "edge",
      "description": "WAF attached to HTTPS Load Balancer with OWASP Top 10 protection and adaptive DDoS defense",
      "config": {
        "rules": [
          "OWASP ModSecurity Core Rule Set 3.3",
          "Rate limiting: 100 req/min per IP",
          "Geo-blocking: Allow US/EU only",
          "SQLi/XSS protection",
          "Bot detection"
        ],
        "adaptiveProtection": true
      },
      "security": ["DDoS Protection", "OWASP Top 10", "Rate Limiting"],
      "cost": "$10/month"
    },
    {
      "id": "vpc-1",
      "name": "Shared VPC",
      "type": "network",
      "provider": "gcp",
      "service": "Virtual Private Cloud",
      "layer": "network",
      "description": "Regional VPC with private subnets and Cloud NAT for egress",
      "config": {
        "mode": "shared",
        "region": "us-central1",
        "subnets": [
          {"name": "gke-pods", "cidr": "10.0.0.0/16", "purpose": "PRIVATE"},
          {"name": "gke-services", "cidr": "10.1.0.0/20", "purpose": "PRIVATE"},
          {"name": "proxy-only", "cidr": "10.2.0.0/24", "purpose": "INTERNAL_HTTPS_LOAD_BALANCER"}
        ],
        "flowLogs": true,
        "privateGoogleAccess": true
      },
      "security": ["Private IP ranges", "VPC Flow Logs", "Private Google Access"],
      "cost": "$15/month"
    },
    {
      "id": "vpc-sc-1",
      "name": "VPC Service Controls",
      "type": "perimeter",
      "provider": "gcp",
      "service": "VPC Service Controls",
      "layer": "security",
      "description": "Security perimeter with ingress/egress policies tested with Cloud Run integration",
      "config": {
        "perimeterName": "atlas-production",
        "accessLevel": "corporate-network-only",
        "services": ["storage.googleapis.com", "sqladmin.googleapis.com", "redis.googleapis.com", "run.googleapis.com"],
        "ingressPolicy": [
          "Allow from Cloud Load Balancing",
          "Allow from Cloud Build (for CI/CD)"
        ],
        "egressPolicy": [
          "Allow to storage.googleapis.com",
          "Allow to sqladmin.googleapis.com",
          "Allow to redis.googleapis.com",
          "Allow to secretmanager.googleapis.com",
          "Deny all other Google API egress by default"
        ],
        "note": "VPC-SC controls Google services only; internet egress (Anthropic) handled by egress proxy",
        "cloudRunTested": true
      },
      "security": ["Data Exfiltration Prevention (Google APIs)", "Ingress Control", "Google API Access Control"],
      "cost": "$0 (included)"
    },
    {
      "id": "gke-1",
      "name": "GKE Regional Cluster",
      "type": "container-orchestration",
      "provider": "gcp",
      "service": "Google Kubernetes Engine",
      "layer": "compute",
      "description": "Regional Autopilot cluster with 3 zones for 99.95% SLA and Confidential Computing",
      "config": {
        "mode": "autopilot",
        "region": "us-central1",
        "zones": ["us-central1-a", "us-central1-b", "us-central1-c"],
        "releaseChannel": "REGULAR",
        "nodeCount": "auto-scaled (6-12 nodes)",
        "machineType": "n2d-standard-2 (Confidential VM)",
        "diskEncryption": "CMEK",
        "workloadIdentity": true,
        "binaryAuthorization": "ENFORCED",
        "shieldedNodes": true,
        "confidentialNodes": true,
        "networkPolicy": true,
        "podSecurityPolicy": "restricted"
      },
      "security": ["Workload Identity", "Binary Authorization", "Shielded Nodes", "Confidential Nodes (AMD SEV)", "Network Policies", "Private Cluster", "CMEK Encryption"],
      "cost": "$220/month (regional +$147)"
    },
    {
      "id": "asm-1",
      "name": "Anthos Service Mesh",
      "type": "service-mesh",
      "provider": "gcp",
      "service": "Anthos Service Mesh",
      "layer": "network",
      "description": "Managed Istio service mesh with automatic mTLS between pods in the mesh; managed services use TLS+IAM",
      "config": {
        "version": "managed",
        "mtls": "STRICT",
        "mtlsScope": "pod-to-pod within mesh",
        "authzPolicy": "DENY_ALL_DEFAULT",
        "telemetry": "enabled",
        "tracing": "enabled",
        "certificateAuthority": "gcp-cas"
      },
      "security": ["mTLS Everywhere", "Zero-Trust Networking", "Authorization Policies", "Certificate Automation"],
      "cost": "$50/month"
    },
    {
      "id": "policy-1",
      "name": "Policy Controller",
      "type": "policy-enforcement",
      "provider": "gcp",
      "service": "Anthos Config Management",
      "layer": "security",
      "description": "OPA-based policy enforcement with Pod Security Standards restricted profile",
      "config": {
        "policyLibrary": "pod-security-policy",
        "enforcement": "dryrun-then-enforce",
        "policies": [
          "Pod Security Standards: restricted",
          "No privileged containers",
          "No host network/PID/IPC",
          "Read-only root filesystem",
          "Drop all capabilities",
          "Require seccomp profile: RuntimeDefault",
          "Resource limits required",
          "Image vulnerability scanning"
        ]
      },
      "security": ["Pod Security Standards", "OPA Policy Enforcement", "Admission Control"],
      "cost": "$0 (included with ASM)"
    },
    {
      "id": "cloudsql-1",
      "name": "Cloud SQL PostgreSQL HA",
      "type": "database",
      "provider": "gcp",
      "service": "Cloud SQL",
      "layer": "data",
      "description": "Regional HA PostgreSQL with automatic failover and read replica",
      "config": {
        "engine": "PostgreSQL 16",
        "tier": "db-custom-2-8192",
        "region": "us-central1",
        "highAvailability": true,
        "readReplicas": 1,
        "backupConfig": {
          "enabled": true,
          "startTime": "03:00",
          "retentionDays": 30,
          "pitrEnabled": true
        },
        "maintenanceWindow": "sun:04:00",
        "encryption": "CMEK",
        "sslMode": "REQUIRED",
        "authorizedNetworks": "none (private IP only)"
      },
      "security": ["CMEK Encryption", "Automated Backups", "PITR", "SSL/TLS Required", "Private IP Only", "IAM Authentication"],
      "cost": "$260/month (HA +$94)"
    },
    {
      "id": "sqlproxy-1",
      "name": "Cloud SQL Auth Proxy",
      "type": "database-proxy",
      "provider": "gcp",
      "service": "Cloud SQL Proxy",
      "layer": "data",
      "description": "Sidecar proxy for secure Cloud SQL connections with IAM authentication",
      "config": {
        "deployment": "sidecar",
        "authentication": "IAM",
        "encryption": "automatic TLS",
        "port": 5432,
        "connectionLimit": 100
      },
      "security": ["IAM Authentication", "Automatic TLS", "No Password Exposure", "Workload Identity Integration"],
      "cost": "$0 (included)"
    },
    {
      "id": "redis-1",
      "name": "Memorystore Redis HA",
      "type": "cache",
      "provider": "gcp",
      "service": "Memorystore for Redis",
      "layer": "data",
      "description": "Standard Tier Redis with automatic failover and CMEK encryption",
      "config": {
        "tier": "STANDARD",
        "version": "7.x",
        "memorySizeGb": 5,
        "region": "us-central1",
        "replicaCount": 1,
        "transitEncryption": "SERVER_AUTHENTICATION",
        "authEnabled": true,
        "maintenanceWindow": "sun:05:00",
        "encryption": "CMEK"
      },
      "security": ["CMEK Encryption", "TLS in-transit", "AUTH enabled", "Private IP only", "Automatic Failover"],
      "cost": "$115/month"
    },
    {
      "id": "storage-1",
      "name": "Cloud Storage (Application Data)",
      "type": "object-storage",
      "provider": "gcp",
      "service": "Cloud Storage",
      "layer": "data",
      "description": "Regional storage bucket with versioning and CMEK encryption",
      "config": {
        "storageClass": "STANDARD",
        "location": "us-central1",
        "versioning": true,
        "lifecyclePolicy": {
          "deleteAfterDays": 90,
          "transitionToNearlineAfterDays": 30
        },
        "uniformBucketLevelAccess": true,
        "encryption": "CMEK",
        "cors": "restricted"
      },
      "security": ["CMEK Encryption", "Versioning", "Uniform Bucket-Level Access", "Lifecycle Policies"],
      "cost": "$23/month"
    },
    {
      "id": "kms-1",
      "name": "Cloud KMS",
      "type": "key-management",
      "provider": "gcp",
      "service": "Cloud Key Management Service",
      "layer": "security",
      "description": "Customer-managed encryption keys with automatic rotation",
      "config": {
        "keyRingLocation": "us-central1",
        "rotationPeriod": "90 days",
        "protectionLevel": "SOFTWARE",
        "keys": [
          "gke-disk-encryption",
          "cloudsql-encryption",
          "redis-encryption",
          "storage-encryption",
          "secret-manager-encryption"
        ]
      },
      "security": ["CMEK", "Automatic Rotation", "Key Access Logging", "IAM Policies"],
      "cost": "$1/month"
    },
    {
      "id": "secrets-1",
      "name": "Secret Manager",
      "type": "secrets-management",
      "provider": "gcp",
      "service": "Secret Manager",
      "layer": "security",
      "description": "Centralized secrets management with CMEK encryption and automatic rotation",
      "config": {
        "replication": "automatic",
        "encryption": "CMEK",
        "rotation": {
          "enabled": true,
          "period": "90 days"
        },
        "versionControl": true,
        "secrets": [
          "anthropic-api-key",
          "redis-auth-string",
          "oauth-client-secret",
          "jwt-signing-key"
        ]
      },
      "security": ["CMEK Encryption", "Automatic Rotation", "Version Control", "IAM Access Control", "Audit Logging"],
      "cost": "$1/month"
    },
    {
      "id": "endpoints-1",
      "name": "Cloud Endpoints",
      "type": "api-gateway",
      "provider": "gcp",
      "service": "Cloud Endpoints",
      "layer": "api",
      "description": "API management via ESP/ESPv2 proxy with OpenAPI 3.0 spec, authentication, and rate limiting",
      "config": {
        "deployment": "ESPv2 sidecar in GKE",
        "spec": "openapi-3.0",
        "authentication": "Firebase Auth + JWT",
        "rateLimiting": {
          "requestsPerMinute": 100,
          "burstSize": 200
        },
        "monitoring": true,
        "logging": "full",
        "cors": "enabled"
      },
      "security": ["API Key Validation", "JWT Authentication", "Rate Limiting", "Request/Response Logging"],
      "cost": "$35/month"
    },
    {
      "id": "cloudrun-1",
      "name": "Cloud Run Workers",
      "type": "serverless-compute",
      "provider": "gcp",
      "service": "Cloud Run",
      "layer": "compute",
      "description": "Serverless background workers for AI processing with VPC-SC integration tested",
      "config": {
        "cpu": "2",
        "memory": "4Gi",
        "maxInstances": 10,
        "minInstances": 0,
        "timeout": "300s",
        "concurrency": 80,
        "vpcConnector": "shared-vpc",
        "vpcEgress": "private-ranges-only",
        "binaryAuthorization": "ENFORCED",
        "encryption": "CMEK",
        "vpcScTested": true
      },
      "security": ["Binary Authorization", "VPC Connector", "CMEK Encryption", "Workload Identity", "VPC-SC Compatible"],
      "cost": "$45/month"
    },
    {
      "id": "nat-1",
      "name": "Cloud NAT",
      "type": "nat-gateway",
      "provider": "gcp",
      "service": "Cloud NAT",
      "layer": "network",
      "description": "Egress NAT for static IP assignment and logging",
      "config": {
        "region": "us-central1",
        "natIpAllocateOption": "AUTO_ONLY",
        "sourceSubnetIpRangesToNat": "ALL_SUBNETWORKS_ALL_IP_RANGES",
        "logConfig": {
          "enable": true,
          "filter": "ALL"
        }
      },
      "security": ["Static IP Assignment", "Connection Logging", "Egress Tracking"],
      "cost": "$10/month"
    },
    {
      "id": "egress-proxy-1",
      "name": "Secure Web Proxy",
      "type": "egress-proxy",
      "provider": "gcp",
      "service": "Secure Web Proxy (or Cloud Run proxy)",
      "layer": "network",
      "description": "FQDN-based egress allow-listing for external API calls (Anthropic)",
      "config": {
        "region": "us-central1",
        "deployment": "Cloud Run proxy with Squid or similar",
        "allowedFQDNs": [
          "api.anthropic.com",
          "accounts.google.com",
          "*.googleapis.com"
        ],
        "defaultAction": "DENY",
        "logging": "full",
        "authentication": "Workload Identity"
      },
      "security": ["FQDN Allow-listing", "Request Logging", "IAM Authentication", "Block Unknown Destinations"],
      "cost": "$15/month"
    },
    {
      "id": "cas-1",
      "name": "Certificate Authority Service",
      "type": "certificate-authority",
      "provider": "gcp",
      "service": "Certificate Authority Service",
      "layer": "security",
      "description": "Private CA for internal certificates used by Anthos Service Mesh",
      "config": {
        "tier": "DevOps",
        "lifetime": "10 years",
        "keyAlgorithm": "RSA_4096",
        "certificateLifetime": "90 days",
        "autoRenewal": true
      },
      "security": ["Private CA", "Automatic Certificate Rotation", "HSM-backed (optional)"],
      "cost": "$200/month"
    },
    {
      "id": "identity-1",
      "name": "Cloud Identity",
      "type": "identity",
      "provider": "gcp",
      "service": "Cloud Identity",
      "layer": "security",
      "description": "Identity and access management with SSO and MFA enforcement",
      "config": {
        "edition": "Premium",
        "sso": true,
        "mfa": "ENFORCED",
        "passwordPolicy": {
          "minLength": 14,
          "complexity": "high",
          "rotationDays": 90
        },
        "sessionTimeout": "8 hours",
        "users": 10
      },
      "security": ["SSO", "MFA Enforced", "Password Policies", "Session Management"],
      "cost": "$60/month"
    },
    {
      "id": "scc-1",
      "name": "Security Command Center Premium",
      "type": "security-monitoring",
      "provider": "gcp",
      "service": "Security Command Center",
      "layer": "security",
      "description": "Security monitoring with Event Threat Detection and Container Threat Detection",
      "config": {
        "tier": "Premium",
        "modules": [
          "Event Threat Detection",
          "Container Threat Detection",
          "Web Security Scanner",
          "Security Health Analytics"
        ],
        "alertRules": [
          "Privileged container detected",
          "Unusual API call pattern",
          "Data exfiltration attempt",
          "Binary authorization violation",
          "Service account key creation",
          "VPC-SC violation",
          "Failed authentication spike",
          "Crypto mining activity",
          "Malware detected in container",
          "Anomalous egress traffic"
        ],
        "notifications": "PubSub + Email"
      },
      "security": ["Threat Detection", "Vulnerability Scanning", "Compliance Monitoring", "Real-time Alerts"],
      "cost": "$150/month"
    },
    {
      "id": "binauth-1",
      "name": "Binary Authorization",
      "type": "container-security",
      "provider": "gcp",
      "service": "Binary Authorization",
      "layer": "security",
      "description": "Container image attestation with vulnerability scanning enforcement",
      "config": {
        "defaultAdmissionRule": "DENY_ALL",
        "allowedRegistries": ["gcr.io/atlas-production"],
        "attestationAuthority": "gcp-cas",
        "vulnerabilityScanningPolicy": {
          "maxCritical": 0,
          "maxHigh": 0,
          "maxMedium": 5
        },
        "signatureVerification": true
      },
      "security": ["Image Signing", "Vulnerability Scanning", "Attestation Required", "Registry Allow-listing"],
      "cost": "$0 (included)"
    },
    {
      "id": "dlp-1",
      "name": "Cloud DLP API",
      "type": "data-protection",
      "provider": "gcp",
      "service": "Cloud Data Loss Prevention",
      "layer": "security",
      "description": "Automatic PII detection and redaction for stored data",
      "config": {
        "inspectTemplates": [
          "PII_DETECTION",
          "PHI_DETECTION",
          "CREDIT_CARD_DETECTION"
        ],
        "deidentifyMethods": ["MASKING", "REDACTION"],
        "scanSchedule": "daily"
      },
      "security": ["PII Detection", "Data Classification", "Automatic Redaction"],
      "cost": "$15/month"
    },
    {
      "id": "logging-1",
      "name": "Cloud Logging",
      "type": "logging",
      "provider": "gcp",
      "service": "Cloud Logging",
      "layer": "observability",
      "description": "Centralized logging with dual sinks: BigQuery (analytics) and Cloud Storage Archive (immutable WORM)",
      "config": {
        "retention": "30 days (in Cloud Logging)",
        "logTypes": ["Admin", "Data Access", "System", "Application"],
        "exportDestinations": [
          {
            "type": "BigQuery",
            "purpose": "Analytics and search",
            "retention": "90 days"
          },
          {
            "type": "Cloud Storage Archive",
            "purpose": "Immutable audit trail",
            "storageClass": "ARCHIVE",
            "bucketLock": {
              "enabled": true,
              "retentionPeriod": "7 years",
              "mode": "LOCKED (WORM)"
            },
            "encryption": "CMEK"
          }
        ],
        "filterExclusions": ["health-checks", "metrics-polling"]
      },
      "security": ["Immutable WORM Storage", "Bucket Lock (7 years)", "Dual Sink Redundancy", "CMEK Encryption", "Access Logging", "Audit Trail"],
      "cost": "$25/month (includes Archive storage)"
    },
    {
      "id": "monitoring-1",
      "name": "Cloud Monitoring",
      "type": "monitoring",
      "provider": "gcp",
      "service": "Cloud Monitoring",
      "layer": "observability",
      "description": "Application and infrastructure monitoring with alerting",
      "config": {
        "dashboards": ["Infrastructure", "Application", "Security"],
        "alertPolicies": [
          "CPU > 80%",
          "Memory > 85%",
          "Error rate > 1%",
          "Latency p95 > 500ms",
          "Security event detected"
        ],
        "notificationChannels": ["email", "pagerduty"]
      },
      "security": ["Performance Monitoring", "Alerting", "SLO Tracking"],
      "cost": "$15/month"
    },
    {
      "id": "firebaseauth-1",
      "name": "Firebase Authentication",
      "type": "authentication",
      "provider": "gcp",
      "service": "Firebase Authentication",
      "layer": "application",
      "description": "User authentication with OAuth 2.0, session management, and token lifecycle controls",
      "config": {
        "providers": ["Google", "Email/Password", "SAML SSO"],
        "sessionManagement": {
          "tokenExpiry": "1 hour",
          "refreshTokenExpiry": "30 days",
          "revokeOnPasswordChange": true,
          "revokeOnRoleChange": true
        },
        "mfa": "optional",
        "rateLimit": "100 requests/hour per IP"
      },
      "security": ["OAuth 2.0", "JWT Tokens", "Session Management", "Token Lifecycle Controls", "MFA Support"],
      "cost": "$0 (free tier)"
    }
  ],
  "connections": [
    {"from": "cdn-1", "to": "lb-1", "protocol": "HTTPS", "note": "CDN enabled on LB backend"},
    {"from": "lb-1", "to": "endpoints-1", "protocol": "HTTPS", "note": "Cloud Armor policy attached to LB"},
    {"from": "endpoints-1", "to": "gke-1", "protocol": "HTTPS"},
    {"from": "gke-1", "to": "asm-1", "protocol": "mTLS", "note": "Pod-to-pod mTLS within mesh"},
    {"from": "gke-1", "to": "sqlproxy-1", "protocol": "TLS+IAM", "note": "Workload Identity authentication"},
    {"from": "sqlproxy-1", "to": "cloudsql-1", "protocol": "TLS"},
    {"from": "gke-1", "to": "redis-1", "protocol": "TLS+AUTH", "note": "Private IP + TLS + Redis AUTH"},
    {"from": "gke-1", "to": "storage-1", "protocol": "TLS+IAM", "note": "Workload Identity + HTTPS"},
    {"from": "gke-1", "to": "cloudrun-1", "protocol": "HTTPS+IAM", "note": "Service-to-service auth via IAM"},
    {"from": "cloudrun-1", "to": "egress-proxy-1", "protocol": "HTTP (proxy)"},
    {"from": "egress-proxy-1", "to": "nat-1", "protocol": "HTTPS"},
    {"from": "nat-1", "to": "internet", "protocol": "HTTPS", "note": "FQDN allow-listed via egress proxy"},
    {"from": "gke-1", "to": "secrets-1", "protocol": "gRPC/TLS+IAM"},
    {"from": "cloudrun-1", "to": "secrets-1", "protocol": "gRPC/TLS+IAM"},
    {"from": "gke-1", "to": "binauth-1", "protocol": "gRPC", "note": "Admission webhook"},
    {"from": "endpoints-1", "to": "firebaseauth-1", "protocol": "JWT"}
  ],
  "securityControls": {
    "network": [
      "Shared VPC with private subnets",
      "VPC Service Controls perimeter (Google APIs)",
      "Cloud Armor WAF attached to HTTPS Load Balancer",
      "Anthos Service Mesh with mTLS for pod-to-pod",
      "Secure Web Proxy for FQDN-based egress allow-listing",
      "Cloud NAT with comprehensive logging",
      "Private Google Access"
    ],
    "compute": [
      "GKE Autopilot Regional (99.95% SLA)",
      "Binary Authorization enforced",
      "Shielded GKE Nodes",
      "Confidential GKE Nodes (AMD SEV)",
      "Policy Controller with Pod Security Standards restricted",
      "Workload Identity (no service account keys)",
      "Cloud Run with Binary Authorization"
    ],
    "data": [
      "CMEK encryption for all data stores",
      "Cloud SQL HA with regional redundancy",
      "Cloud SQL Auth Proxy (no raw DB access)",
      "Memorystore Redis HA with TLS + AUTH",
      "Cloud Storage versioning + lifecycle policies",
      "Secret Manager with CMEK and rotation",
      "Point-in-time recovery enabled"
    ],
    "access": [
      "Cloud Identity Premium with SSO/MFA",
      "Firebase Authentication with token lifecycle",
      "Cloud Endpoints API authentication",
      "IAM policies with least privilege",
      "Workload Identity for GKE/Cloud Run",
      "No long-lived service account keys"
    ],
    "detection": [
      "Security Command Center Premium",
      "10 SCC alert rules configured",
      "Event Threat Detection",
      "Container Threat Detection",
      "Cloud DLP for PII detection",
      "VPC Flow Logs",
      "Cloud NAT logging"
    ],
    "compliance": [
      "SOC 2 Type II controls",
      "ISO 27001 controls",
      "GDPR data protection",
      "HIPAA-eligible architecture",
      "7-year immutable audit log retention (WORM)",
      "Dual sink logging (BigQuery + GCS Archive)"
    ]
  },
  "operationalNotes": {
    "deployment": "Regional deployment in us-central1 across 3 zones for maximum availability",
    "scalability": "Designed for 10 clients, can scale to 50 without architecture changes",
    "backupStrategy": "Automated daily backups with 30-day retention and point-in-time recovery",
    "disasterRecovery": "Regional HA with automatic failover, 99.95% SLA, RPO < 1 hour, RTO < 4 hours",
    "maintenance": "Automated patching via GKE release channels and Cloud SQL maintenance windows",
    "monitoring": "Comprehensive monitoring with Cloud Monitoring, SCC Premium, and ASM telemetry",
    "egressPattern": "FQDN allow-listing via Secure Web Proxy (Anthropic only) with Cloud NAT for static IPs",
    "auditCompliance": "Dual-sink immutable logging: BigQuery (90d analytics) + Cloud Storage Archive (7y WORM)",
    "upgradeFrom": "tier1-gcp-architecture-secure.json (+$317/month for production hardening)"
  }
}
